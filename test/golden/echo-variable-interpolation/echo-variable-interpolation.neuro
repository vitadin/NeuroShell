%% Echo command variable interpolation test
%% Tests variable interpolation combined with raw mode functionality

%% Set up test variables
\set[greeting="Hello"]
\set[name="World"]
\set[text_with_escapes="Line1\nLine2"]

%% Test basic variable interpolation
\echo ${greeting}, ${name}!

%% Test variable interpolation with raw mode (variables expanded, then literal output)
\echo[raw=true] Message: ${text_with_escapes}

%% Test variable interpolation with normal mode (variables expanded, then escape sequences interpreted)
\echo[raw=false] Message: ${text_with_escapes}

%% Test mixing variables and escape sequences in raw mode
\echo[raw=true] ${greeting}\n${name}\tGreeting

%% Test mixing variables and escape sequences in normal mode
\echo[raw=false] ${greeting}\n${name}\tGreeting

%% Test storing interpolated results
\echo[raw=true,to=raw_result] Result: ${greeting}\n${name}
\get[raw_result]

\echo[raw=false,to=interpreted_result] Result: ${greeting}\n${name}
\get[interpreted_result]

%% Test with system variables
\echo System info: User=${@user}, TestMode=${#test_mode}

%% Test with undefined variables (should become empty)
\echo[raw=true] Undefined: ${undefined_var}\nDefined: ${name}

%% Test complex variable interpolation
\set[complex="Value with ${greeting} and escapes\n"]
\echo[raw=true] Complex: ${complex}
\echo[raw=false] Complex: ${complex}