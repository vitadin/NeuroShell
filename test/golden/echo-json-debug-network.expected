Setting _echo_command = true
%%> "\\set[debug_network={\"http_request\": {\"method\": \"POST\", \"url\": \"https://api.openai.com/v1/chat/completions\", \"headers\": {\"Content-Type\": \"application/json\", \"Authorization\": \"Bearer sk-***\"}, \"body\": \"{\\\"model\\\":\\\"gpt-4\\\",\\\"messages\\\":[{\\\"role\\\":\\\"user\\\",\\\"content\\\":\\\"Hello\\\"}]}\"}, \"http_response\": {\"status_code\": 200, \"headers\": {\"Content-Type\": \"application/json\"}, \"body\": \"{\\\"choices\\\":[{\\\"message\\\":{\\\"content\\\":\\\"Hello there!\\\"}}]}\"}, \"timing\": {\"request_time\": \"2024-01-01T12:00:00Z\", \"response_time\": \"2024-01-01T12:00:01Z\", \"duration_ms\": 1000}}]"
Setting debug_network = {"http_request": {"method": "POST", "url": "https://api.openai.com/v1/chat/completions", "headers": {"Content-Type": "application/json", "Authorization": "Bearer sk-***"}, "body": "{\"model\":\"gpt-4\",\"messages\":[{\"role\":\"user\",\"content\":\"Hello\"}]}"}, "http_response": {"status_code": 200, "headers": {"Content-Type": "application/json"}, "body": "{\"choices\":[{\"message\":{\"content\":\"Hello there!\"}}]}"}, "timing": {"request_time": "2024-01-01T12:00:00Z", "response_time": "2024-01-01T12:00:01Z", "duration_ms": 1000}}
%%> "\\echo === DEBUG NETWORK DATA (Default) ==="
=== DEBUG NETWORK DATA (Default) ===
%%> "\\echo-json ${debug_network}"
{
  "http_request": {
    "body": "{\"model\":\"gpt-4\",\"messages\":[{\"role\":\"user\",\"content\":\"Hello\"}]}",
    "headers": {
      "Authorization": "Bearer sk-***",
      "Content-Type": "application/json"
    },
    "method": "POST",
    "url": "https://api.openai.com/v1/chat/completions"
  },
  "http_response": {
    "body": "{\"choices\":[{\"message\":{\"content\":\"Hello there!\"}}]}",
    "headers": {
      "Content-Type": "application/json"
    },
    "status_code": 200
  },
  "timing": {
    "duration_ms": 1000,
    "request_time": "2024-01-01T12:00:00Z",
    "response_time": "2024-01-01T12:00:01Z"
  }
}
%%> "\\echo === DEBUG NETWORK DATA (Compact) ==="
=== DEBUG NETWORK DATA (Compact) ===
%%> "\\echo-json[indent=0] ${debug_network}"
{"http_request":{"body":"{\"model\":\"gpt-4\",\"messages\":[{\"role\":\"user\",\"content\":\"Hello\"}]}","headers":{"Authorization":"Bearer sk-***","Content-Type":"application/json"},"method":"POST","url":"https://api.openai.com/v1/chat/completions"},"http_response":{"body":"{\"choices\":[{\"message\":{\"content\":\"Hello there!\"}}]}","headers":{"Content-Type":"application/json"},"status_code":200},"timing":{"duration_ms":1000,"request_time":"2024-01-01T12:00:00Z","response_time":"2024-01-01T12:00:01Z"}}
%%> "\\echo === DEBUG NETWORK DATA (4-space) ==="
=== DEBUG NETWORK DATA (4-space) ===
%%> "\\echo-json[indent=4] ${debug_network}"
{
    "http_request": {
        "body": "{\"model\":\"gpt-4\",\"messages\":[{\"role\":\"user\",\"content\":\"Hello\"}]}",
        "headers": {
            "Authorization": "Bearer sk-***",
            "Content-Type": "application/json"
        },
        "method": "POST",
        "url": "https://api.openai.com/v1/chat/completions"
    },
    "http_response": {
        "body": "{\"choices\":[{\"message\":{\"content\":\"Hello there!\"}}]}",
        "headers": {
            "Content-Type": "application/json"
        },
        "status_code": 200
    },
    "timing": {
        "duration_ms": 1000,
        "request_time": "2024-01-01T12:00:00Z",
        "response_time": "2024-01-01T12:00:01Z"
    }
}
%%> "\\echo-json[to=formatted_debug] ${debug_network}"
{
  "http_request": {
    "body": "{\"model\":\"gpt-4\",\"messages\":[{\"role\":\"user\",\"content\":\"Hello\"}]}",
    "headers": {
      "Authorization": "Bearer sk-***",
      "Content-Type": "application/json"
    },
    "method": "POST",
    "url": "https://api.openai.com/v1/chat/completions"
  },
  "http_response": {
    "body": "{\"choices\":[{\"message\":{\"content\":\"Hello there!\"}}]}",
    "headers": {
      "Content-Type": "application/json"
    },
    "status_code": 200
  },
  "timing": {
    "duration_ms": 1000,
    "request_time": "2024-01-01T12:00:00Z",
    "response_time": "2024-01-01T12:00:01Z"
  }
}
%%> "\\echo Stored debug data length check:"
Stored debug data length check:
%%> "\\get[formatted_debug]"
formatted_debug = {                                                                          
  "http_request": {                                                                          
    "body": "{\"model\":\"gpt-4\",\"messages\":[{\"role\":\"user\",\"content\":\"Hello\"}]}",
    "headers": {                                                                             
      "Authorization": "Bearer sk-***",                                                      
      "Content-Type": "application/json"                                                     
    },                                                                                       
    "method": "POST",                                                                        
    "url": "https://api.openai.com/v1/chat/completions"                                      
  },                                                                                         
  "http_response": {                                                                         
    "body": "{\"choices\":[{\"message\":{\"content\":\"Hello there!\"}}]}",                  
    "headers": {                                                                             
      "Content-Type": "application/json"                                                     
    },                                                                                       
    "status_code": 200                                                                       
  },                                                                                         
  "timing": {                                                                                
    "duration_ms": 1000,                                                                     
    "request_time": "2024-01-01T12:00:00Z",                                                  
    "response_time": "2024-01-01T12:00:01Z"                                                  
  }                                                                                          
}                                                                                            
%%> "\\set[simple_debug={\"request\": {\"method\": \"GET\"}, \"response\": {\"status\": 200}, \"duration\": 500}]"
Setting simple_debug = {"request": {"method": "GET"}, "response": {"status": 200}, "duration": 500}
%%> "\\echo === SIMPLE DEBUG DATA ==="
=== SIMPLE DEBUG DATA ===
%%> "\\echo-json ${simple_debug}"
{
  "duration": 500,
  "request": {
    "method": "GET"
  },
  "response": {
    "status": 200
  }
}
%%> "\\echo === MALFORMED DEBUG DATA ==="
=== MALFORMED DEBUG DATA ===
%%> "\\echo-json {\"request\": {\"method\": \"POST\", \"incomplete\": }"
Error: Invalid JSON - invalid character '}' looking for beginning of value
Original input: {"request": {"method": "POST", "incomplete": }            