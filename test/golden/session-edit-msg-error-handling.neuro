%% Test session-edit-msg error handling and validation
\set[_echo_command="true"]

%% Create session with limited messages for bounds testing
\session-new[system="Test assistant for error handling"] error_test
\session-add-usermsg Only message in session

%% Test missing idx parameter
\try \session-edit-msg New content without idx
\get[@error]

%% Test empty content
\try \session-edit-msg[idx=1] 
\get[@error]

%% Test whitespace-only content
\try \session-edit-msg[idx=1]    
\get[@error]

%% Test invalid idx formats
\try \session-edit-msg[idx=abc] Invalid index format
\get[@error]

\try \session-edit-msg[idx=.] Empty dot format
\get[@error]

\try \session-edit-msg[idx=.abc] Invalid dot format
\get[@error]

%% Test out of bounds - reverse order
\try \session-edit-msg[idx=2] Out of bounds reverse
\get[@error]

\try \session-edit-msg[idx=0] Zero index reverse
\get[@error]

%% Test out of bounds - normal order
\try \session-edit-msg[idx=.2] Out of bounds normal
\get[@error]

\try \session-edit-msg[idx=.0] Zero index normal
\get[@error]

%% Test with nonexistent session
\try \session-edit-msg[session=nonexistent, idx=1] Edit nonexistent
\get[@error]

%% Test with empty session
\session-new[system="Empty session"] empty_test
\try \session-edit-msg[session=empty_test, idx=1] Edit empty session
\get[@error]

%% Clean up
\session-delete error_test
\session-delete empty_test