%% Testing try-silent error handling behavior
%% This test verifies that try-silent combinations properly handle errors
%% and maintain correct boundary marker state

\set[_echo_command="true"]

%% Show initial state
\echo === Try-Silent Error Handling Test ===

%% Test 1: try-silent with command that fails
\echo Testing try-silent with failing command...
\try \silent \unknown-command-that-fails
\echo After try-silent error (should display)

%% Test 2: Verify error variables are set correctly
\echo Error status: ${@status}
\echo Error message: ${@error}

%% Test 3: try-silent with command that succeeds
\echo Testing try-silent with successful command...
\try \silent \set[test_var=success]
\echo After try-silent success (should display)
\echo Success status: ${@status}
\echo Test variable: ${test_var}

%% Test 4: Nested try blocks with silent
\echo Testing nested try blocks...
\try \echo Starting outer try
\try \silent \echo Inner try-silent (should be silent)
\echo After nested try blocks

%% Test 5: Multiple try-silent commands in sequence
\echo Testing multiple try-silent commands...
\try \silent \unknown-cmd1
\echo After first try-silent
\try \silent \unknown-cmd2  
\echo After second try-silent
\try \silent \set[final=done]
\echo After third try-silent: ${final}

%% Final verification
\echo === Test completed successfully ===
