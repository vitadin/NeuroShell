%% Gemini Thinking Experiment - Complex Reasoning Test
%% Purpose: Test Gemini's thinking capabilities with progressive logic challenges
%% Note: Uses thinking_budget parameter to enable deeper reasoning

\set _style dark1

\echo "=== Gemini Thinking Experiment - Step 1 ==="
\echo "Step 1: Activating Gemini API key from environment..."

%% Verify API key is activated
\llm-api-show[provider=gemini]

%% First, activate the Gemini API key from local environment
\llm-api-activate[provider=gemini, key=local.GEMINI_API_KEY]

%% Verify API key is activated
\llm-api-show[provider=gemini]


%% STEP 2
\echo "Step 2: Creating Gemini model with thinking capabilities..."
\echo "Using thinking_budget=4096 for complex reasoning tasks"
\gemini-model-new[catalog_id="GM25F", thinking_budget="4096", temperature="0.3"] thinking-experiment-model

%% STEP 3
\echo "Step 3: Check that the thinking model was created successfully"
\model-status

%% STEP 4
\echo "Step 4: Activate the thinking model for use"
\model-activate thinking-experiment-model

%% STEP 5
\echo "Step 5: Verify the thinking model is active"
\echo "Active model: ${#active_model_name}"
\echo "Provider: ${#active_model_provider}"

%% STEP 6: Progressive Logic Reasoning Test
\echo "Step 6: Testing Gemini thinking capabilities with logic puzzle chain..."
\echo "This tests whether thinking_budget enables deeper reasoning."
\echo ""

%% Message 1: Setup the logic puzzle
\echo ">>>>>>Message 1: Setting up a logic puzzle foundation..."
\send I have 3 boxes: red, blue, green. One contains gold, one silver, one copper.

\echo ""

%% Message 2: Add logical constraints (requires reasoning)
\echo ">>>>>>Message 2: Adding logical constraints requiring deduction..."
\send The red box doesn't contain gold. The blue box contains a metal more valuable than copper. What's in each box?

\echo ""

%% Message 3: Increase complexity (requires building on previous logic)
\echo ">>>>>>Message 3: Expanding puzzle complexity..."
\send Now I add 2 more boxes: yellow and purple. Yellow has the same metal type as blue. Purple has lower value than green. What's the new arrangement?

\echo ""

%% Message 4: Multi-step reasoning (requires complex manipulation)
\echo ">>>>>>Message 4: Multi-step logical manipulation..."
\send If I swap the contents of the two most valuable boxes, then move the least valuable to the first position, what's the final order?

\echo ""

%% Message 5: Probability reasoning (requires context + analysis)
\echo ">>>>>>Message 5: Strategic reasoning with uncertainty..."
\send Based on our original 3-box setup, which box would you open first to maximize expected value?

\echo ""

%% Message 6: Meta-cognitive analysis (requires self-reflection)
\echo ">>>>>>Message 6: Meta-cognitive reasoning test..."
\send Explain your reasoning process for the previous question. How did you weigh the probabilities?

\echo ""

%% STEP 7
\echo "Step 7: Thinking experiment complete. Reviewing session..."
\echo "First puzzle setup: ${.1}"
\echo "Latest reasoning explanation: ${1}"
\session-list
\session-show Session 1

%% STEP 8
\echo "Step 8: Cleanup - deleting the thinking experiment model..."
\model-delete thinking-experiment-model
\model-status
